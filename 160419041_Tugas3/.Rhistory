# alt
#str(house.price)
library(dplyr)
library(tidyr)
### Housing group by Date (year)
price.byHousing <- house.price %>%
mutate(year = format(Date, "%Y")) %>%
group_by(year) %>%
summarise(across('City of London':'Westminster', mean))
# Convert year to POSIXct
price.byHousing$year <- as.POSIXct(price.byHousing$year, format = "%Y")
# Melt
price.byHousing.melted <- price.byHousing %>%
select(year, 'City of London':'Bexley') %>%
gather(key='housing', value='price', -year)
### Region group by Date (year)
price.byRegion <- house.price %>%
mutate(year = format(Date,"%Y")) %>%
group_by(year) %>%
summarise(across('NORTH EAST':'SOUTH WEST', mean))
# Convert year to POSIXct
price.byRegion$year <- as.POSIXct(price.byRegion$year, format = "%Y")
# Melt
price.byRegion.melted <- price.byRegion %>%
select(year, 'NORTH EAST':'SOUTH WEST') %>%
gather(key='region', value='price', -year)
library(ggplot2)
#### ANALYSIS ####
# Set parameters
housing <- names(price.byHousing[2:34])
region <- names(price.byRegion[2:10])
# Graph price by housing and region
ggplot(price.byHousing.melted, aes(x=year, y=price, colour=housing)) +
geom_line() + theme_bw() + labs(title="Housing price for City of London, Barking & Dagenham, Barnet, and Bexley", x='Year', y='Price', subtitle="")
ggplot(price.byRegion.melted, aes(x=year, y=price, colour=region)) +
geom_line() + theme_bw() + labs(title="Housing price for each region in UK", x='Year', y='Price', subtitle="")
# test <- ggplot(price.byHousing.melted[housing %in% c("City of London", "Barking & Dagenham", "Barnet", "Bexley")],
#        aes(x=year, y=price)) + geom_line() + facet_wrap(~housing, scales = 'free_y') +
#   theme_bw()
#
# test <- ggplot(price.byRegion[region %in% c('LONDON', 'EAST OF ENGLAND')],
#                aes(x=year, y=price)) + geom_line() + facet_wrap(~region, scales = 'free_y') +
#   theme_bw()
View(price.byHousing)
View(price.byHousing.melted)
#### NORMALITY TEST ####
ggdensity(house.price.melted, "main=Housing price for City of London, Barking & Dagenham, Barnet, and Bexley", xlab="price")
install.packages("ggpubr")
#### NORMALITY TEST ####
library(ggpubr)
ggdensity(house.price.melted, "main=Housing price for City of London, Barking & Dagenham, Barnet, and Bexley", xlab="price")
#### DATA PREPARATION ####
# Import
library(readxl)
excel_sheets('datasets/UK House price index.xls')
house.price <- read_excel('datasets/UK House price index.xls', sheet="Average price")
lapply(house.price, class) # Cek class tiap kolom pada dataframe
# alt
#str(house.price)
library(dplyr)
library(tidyr)
### Housing group by Date (year)
price.byHousing <- house.price %>%
mutate(year = format(Date, "%Y")) %>%
group_by(year) %>%
summarise(across('City of London':'Westminster', mean))
# Convert year to POSIXct
price.byHousing$year <- as.POSIXct(price.byHousing$year, format = "%Y")
# Melt
price.byHousing.melted <- price.byHousing %>%
select(year, 'City of London':'Bexley') %>%
gather(key='housing', value='price', -year)
### Region group by Date (year)
price.byRegion <- house.price %>%
mutate(year = format(Date,"%Y")) %>%
group_by(year) %>%
summarise(across('NORTH EAST':'SOUTH WEST', mean))
# Convert year to POSIXct
price.byRegion$year <- as.POSIXct(price.byRegion$year, format = "%Y")
# Melt
price.byRegion.melted <- price.byRegion %>%
select(year, 'NORTH EAST':'SOUTH WEST') %>%
gather(key='region', value='price', -year)
library(ggplot2)
### EDA ####
# Set parameters
housing <- names(price.byHousing[2:34])
region <- names(price.byRegion[2:10])
# Graph price by housing and region
ggplot(price.byHousing.melted, aes(x=year, y=price, colour=housing)) +
geom_line() + theme_bw() + labs(title="Housing price for City of London, Barking & Dagenham, Barnet, and Bexley", x='Year', y='Price', subtitle="")
ggplot(price.byRegion.melted, aes(x=year, y=price, colour=region)) +
geom_line() + theme_bw() + labs(title="Housing price for each region in UK", x='Year', y='Price', subtitle="")
# test <- ggplot(price.byHousing.melted[housing %in% c("City of London", "Barking & Dagenham", "Barnet", "Bexley")],
#        aes(x=year, y=price)) + geom_line() + facet_wrap(~housing, scales = 'free_y') +
#   theme_bw()
#
# test <- ggplot(price.byRegion[region %in% c('LONDON', 'EAST OF ENGLAND')],
#                aes(x=year, y=price)) + geom_line() + facet_wrap(~region, scales = 'free_y') +
#   theme_bw()
#### NORMALITY TEST ####
library(ggpubr)
ggdensity(house.price.melted, "main=Housing price for City of London, Barking & Dagenham, Barnet, and Bexley", xlab="price")
ggdensity(price.byHousing, "main=Housing price for City of London, Barking & Dagenham, Barnet, and Bexley", xlab="price")
ggdensity(price.byHousing$price, "main=Housing price for City of London, Barking & Dagenham, Barnet, and Bexley", xlab="price")
ggdensity(price.byHousing.melted$price, "main=Housing price for City of London, Barking & Dagenham, Barnet, and Bexley", xlab="price")
ggdensity(price.byHousing.melted$price, "main=Housing price for City of London, Barking & Dagenham, Barnet, and Bexley", xlab="price")
install.packages("nortest")
#### NORMALITY TEST ####
library(nortest)
lillie.test(price.byRegion.melted)
lillie.test(price.byRegion.melted$price)
hist(price.byRegion.melted$price)
install.packages("dgof")
ks.test(price.byRegion$price)
ks.test(price.byRegion.melted$price)
ks.test(price.byRegion.melted$price, "pnorm")
View(price.byRegion.melted)
View(price.byRegion.melted)
# Test KS TEST
Y <- rnorm(150)
Y
ks.test(Y, 'pnorm')
ks.test(house.price$England, "pnorm")
View(price.byRegion)
ks.test(price.byRegion$LONDON, price.byRegion$`EAST OF ENGLAND`)
#### NORMALITY TEST ####
qqplot(price.byRegion$LONDON, price.byRegion$`EAST OF ENGLAND`)
#### NORMALITY TEST ####
hist(price.byRegion$LONDON, breaks=50, include.lowest = F, right = F)
#### NORMALITY TEST ####
hist(house.price$LONDON, breaks=50, include.lowest = F, right = F)
qqplot(house.price$LONDON, house.price$`EAST OF ENGLAND`)
ks.test(house.price$LONDON, house.price$`EAST OF ENGLAND`)
ks.test(house.price$LONDON, house.price$`EAST OF ENGLAND`)
View(house.price)
View(house.price)
View(house.price)
View(price.byHousing)
ks.test(price.byRegion.melted$price, "pnorm")
ggplot(price.byHousing.melted, aes(x=year, y=price, colour=housing)) +
geom_line() + theme_bw() + labs(title="Housing price for City of London, Barking & Dagenham, Barnet, and Bexley", x='Year', y='Price', subtitle="")
#### DATA PREPARATION ####
# Import
library(readxl)
excel_sheets('datasets/UK House price index.xls')
house.price <- read_excel('datasets/UK House price index.xls', sheet="Average price")
lapply(house.price, class) # Cek class tiap kolom pada dataframe
# alt
#str(house.price)
library(dplyr)
library(tidyr)
### Housing group by Date (year)
price.byHousing <- house.price %>%
mutate(year = format(Date, "%Y")) %>%
group_by(year) %>%
summarise(across('City of London':'Westminster', mean))
# Convert year to POSIXct
price.byHousing$year <- as.POSIXct(price.byHousing$year, format = "%Y")
# Melt
price.byHousing.melted <- price.byHousing %>%
select(year, 'City of London':'Bexley') %>%
gather(key='housing', value='price', -year)
### Region group by Date (year)
price.byRegion <- house.price %>%
mutate(year = format(Date,"%Y")) %>%
group_by(year) %>%
summarise(across('NORTH EAST':'SOUTH WEST', mean))
# Convert year to POSIXct
price.byRegion$year <- as.POSIXct(price.byRegion$year, format = "%Y")
# Melt
price.byRegion.melted <- price.byRegion %>%
select(year, 'NORTH EAST':'SOUTH WEST') %>%
gather(key='region', value='price', -year)
library(ggplot2)
### EDA ####
# Set parameters
housing <- names(price.byHousing[2:34])
region <- names(price.byRegion[2:10])
# Graph price by housing and region
ggplot(price.byHousing.melted, aes(x=year, y=price, colour=housing)) +
geom_line() + theme_bw() + labs(title="Housing price for City of London, Barking & Dagenham, Barnet, and Bexley", x='Year', y='Price', subtitle="")
ggplot(price.byRegion.melted, aes(x=year, y=price, colour=region)) +
geom_line() + theme_bw() + labs(title="Housing price for each region in UK", x='Year', y='Price', subtitle="")
# test <- ggplot(price.byHousing.melted[housing %in% c("City of London", "Barking & Dagenham", "Barnet", "Bexley")],
#        aes(x=year, y=price)) + geom_line() + facet_wrap(~housing, scales = 'free_y') +
#   theme_bw()
#
# test <- ggplot(price.byRegion[region %in% c('LONDON', 'EAST OF ENGLAND')],
#                aes(x=year, y=price)) + geom_line() + facet_wrap(~region, scales = 'free_y') +
#   theme_bw()
#### NORMALITY TEST ####
hist(house.price$LONDON, breaks=50, include.lowest = F, right = F)
qqplot(house.price$LONDON, house.price$`EAST OF ENGLAND`)
library(dgof)
ks.test(house.price$LONDON, house.price$`EAST OF ENGLAND`)
ks.test(price.byRegion.melted$price, "pnorm")
# Kolmogorov-Smirnov test example
# Y <- rnorm(150)
# ks.test(Y, 'pnorm')
# result p = 0.6814 < 0.05 (significance level) (means fail to reject null hypothesis) (and conclude that data is normally distributed)
#### NORMALITY TEST ####
hist(house.price$LONDON, breaks=100, include.lowest = F, right = F)
#### NORMALITY TEST ####
hist(house.price$LONDON, breaks=50, include.lowest = F, right = F)
#### NORMALITY TEST ####
hist(house.price$LONDON, breaks=10, include.lowest = F, right = F)
#### NORMALITY TEST ####
hist(house.price$LONDON, breaks=60, include.lowest = F, right = F)
#### NORMALITY TEST ####
hist(house.price$LONDON, breaks=50, include.lowest = F, right = F)
qqplot(house.price$LONDON, house.price$`EAST OF ENGLAND`)
qqplot(house.price$LONDON,"pnorm")
hist(house.price$'EAST OF ENGLAND', breaks=50, include.lowest = F, right = F)
#### NORMALITY TEST ####
hist(house.price$LONDON, breaks=50, include.lowest = F, right = F)
ks.test(price.byRegion$LONDON, price.byRegion$'EAST OF ENGLAND')
ks.test(house.price$LONDON, house.price$`EAST OF ENGLAND`)
ks.test(price.byRegion$LONDON, price.byRegion$'EAST OF ENGLAND')
#### NORMALITY TEST ####
hist(house.price$LONDON, breaks=50, include.lowest = F, right = F)
hist(house.price$'EAST OF ENGLAND', breaks=50, include.lowest = F, right = F)
qqplot(house.price$LONDON, house.price$`EAST OF ENGLAND`)
qqplot(price.byRegion$LONDON, price.byRegion$'EAST OF ENGLAND')
qqplot(house.price$LONDON, house.price$'EAST OF ENGLAND')
# ks.test(house.price$LONDON, house.price$'EAST OF ENGLAND')
ks.test(price.byRegion$LONDON, price.byRegion$'EAST OF ENGLAND')
ggplot(price.byHousing.melted, aes(x=year, y=price, fill=housing)) +
geom_boxplot()
#### DATA PREPARATION ####
# Import
library(readxl)
excel_sheets('datasets/UK House price index.xls')
house.price <- read_excel('datasets/UK House price index.xls', sheet="Average price")
lapply(house.price, class) # Cek class tiap kolom pada dataframe
# alternative
#str(house.price)
library(dplyr)
library(tidyr)
### Housing group by Date (year)
price.byHousing <- house.price %>%
mutate(year = format(Date, "%Y")) %>%
group_by(year) %>%
summarise(across('City of London':'Westminster', mean))
# Convert year to POSIXct
price.byHousing$year <- as.POSIXct(price.byHousing$year, format = "%Y")
### Region group by Date (year)
price.byRegion <- house.price %>%
mutate(year = format(Date,"%Y")) %>%
group_by(year) %>%
summarise(across('NORTH EAST':'SOUTH WEST', mean))
# Convert year to POSIXct
price.byRegion$year <- as.POSIXct(price.byRegion$year, format = "%Y")
# Comparing housing price in City of London and Barking & Dagenham
# Melt
price.byHousing.melted <- price.byHousing %>%
select(year, 'City of London':'Barking & Dagenham') %>%
gather(key='housing', value='price', -year)
# Comparing housing price in LONDON and NORTH WEST
# Melt
price.byRegion.melted <- price.byRegion %>%
select(year, c('LONDON','NORTH WEST')) %>%
gather(key='region', value='price', -year)
#### EDA ####
library(ggplot2)
# Set parameter
housing <- names(price.byHousing[2:34])
region <- names(price.byRegion[2:10])
# Graph price by housing and region
housing.plot1 = ggplot(price.byHousing.melted, aes(x=year, y=price, colour=housing)) +
geom_line() + theme_bw() + labs(title="Housing price for City of London and Barking
& Dagenham", x='Year', y='Price', subtitle="")
housing.plot1
region.plot1 = ggplot(price.byRegion.melted, aes(x=year, y=price, colour=region)) +
geom_line() + theme_bw() + labs(title="Housing price for London and North West Region",
x='Year', y='Price', subtitle="")
region.plot1
# Boxplot by year
price.byHousing <- house.price %>%
mutate(year = format(Date, "%Y")) %>%
group_by(year)
price.byHousing$year <- as.factor(price.byHousing$year)
price.byHousing.melted <- price.byHousing %>%
select(year, 'City of London':'Barking & Dagenham') %>%
gather(key='housing', value='price', -year)
ggplot(price.byHousing.melted, aes(x=year, y=price, fill=housing)) +
geom_boxplot()
ggplot(price.byHousing.melted, aes(x=year, y=price, fill=housing)) +
geom_boxplot() +
facet_wrap(~housing)
#### DATA PREPARATION ####
# Import
library(readxl)
excel_sheets('datasets/UK House price index.xls')
house.price <- read_excel('datasets/UK House price index.xls', sheet="Average price")
lapply(house.price, class) # Cek class tiap kolom pada dataframe
# alternative
#str(house.price)
library(dplyr)
library(tidyr)
### Housing group by Date (year)
price.byHousing <- house.price %>%
mutate(year = format(Date, "%Y")) %>%
group_by(year) %>%
summarise(across('City of London':'Westminster', mean))
# Convert year to POSIXct
price.byHousing$year <- as.POSIXct(price.byHousing$year, format = "%Y")
### Region group by Date (year)
price.byRegion <- house.price %>%
mutate(year = format(Date,"%Y")) %>%
group_by(year) %>%
summarise(across('NORTH EAST':'SOUTH WEST', mean))
# Convert year to POSIXct
price.byRegion$year <- as.POSIXct(price.byRegion$year, format = "%Y")
View(price.byHousing)
price.byHousing <- house.price %>%
mutate(year = format(Date, "%Y")) %>%
group_by(year)
price.byHousing$year <- as.factor(price.byHousing$year)
# Boxplot by year
price.byHousing <- house.price %>%
mutate(c(1:23)) %>%
group_by(year)
# Boxplot by year
price.byHousing <- house.price %>%
mutate(c(1:)) %>%
group_by(year)
# Boxplot by year
price.byHousing <- house.price %>%
mutate(c(1:)) %>%
group_by(year)
# Boxplot by year
price.byHousing <- house.price %>%
mutate(year = c(1:)) %>%
group_by(year)
# Boxplot by year
price.byHousing <- house.price %>%
mutate(year = c(1:)) %>%
group_by(year)
# Boxplot by year
price.byHousing <- house.price %>%
mutate(year = format(Date, "%Y")) %>%
group_by(year)
price.byHousing$year <- as.factor(price.byHousing$year)
price.byHousing$year <- as.numeric(price.byHousing$year)
price.byHousing$year <- as.character(price.byHousing$year)
price.byHousing$year <- as.numeric_version(price.byHousing$year)
price.byHousing$year <- as.numeric(price.byHousing$year)
price.byHousing$year <- price.byHousing$year - 1
price.byHousing$year <- price.byHousing$year - 1994
price.byHousing$year <- price.byHousing$year - matrix(1994, ncol=1, nrow=566)
# Boxplot by year
price.byHousing <- house.price %>%
mutate(year = format(Date, "%Y")) %>%
group_by(year)
price.byHousing.melted <- price.byHousing %>%
select(year, 'City of London':'Barking & Dagenham') %>%
gather(key='housing', value='price', -year)
price.byHousing$year <- as.numeric(price.byHousing$year)
# Boxplot by year
price.byHousing <- house.price %>%
mutate(year = format(Date, "%Y")) %>%
group_by(year)
price.byHousing.melted <- price.byHousing %>%
select(year, 'City of London':'Barking & Dagenham') %>%
gather(key='housing', value='price', -year)
price.byHousing.melted$year <- as.numeric(price.byHousing$year)
#### DATA PREPARATION ####
# Import
library(readxl)
excel_sheets('datasets/UK House price index.xls')
house.price <- read_excel('datasets/UK House price index.xls', sheet="Average price")
lapply(house.price, class) # Cek class tiap kolom pada dataframe
# alternative
#str(house.price)
library(dplyr)
library(tidyr)
### Housing group by Date (year)
price.byHousing <- house.price %>%
mutate(year = format(Date, "%Y")) %>%
group_by(year) %>%
summarise(across('City of London':'Westminster', mean))
# Convert year to POSIXct
price.byHousing$year <- as.POSIXct(price.byHousing$year, format = "%Y")
### Region group by Date (year)
price.byRegion <- house.price %>%
mutate(year = format(Date,"%Y")) %>%
group_by(year) %>%
summarise(across('NORTH EAST':'SOUTH WEST', mean))
# Convert year to POSIXct
price.byRegion$year <- as.POSIXct(price.byRegion$year, format = "%Y")
# Boxplot by year
price.byHousing <- house.price %>%
mutate(year = format(Date, "%Y")) %>%
group_by(year)
price.byHousing.melted <- price.byHousing %>%
select(year, 'City of London':'Barking & Dagenham') %>%
gather(key='housing', value='price', -year)
price.byHousing.melted$year <- as.numeric(price.byHousing.melted$year)
price.byHousing.melted$year <- price.byHousing.melted$year - matrix(1994, ncol=1, nrow=566)
ggplot(price.byHousing.melted, aes(x=year, y=price, fill=housing)) +
geom_boxplot() +
facet_wrap(~housing)
price.byHousing.melted$year <- as.factor(price.byHousing.melted$year)
ggplot(price.byHousing.melted, aes(x=year, y=price, fill=housing)) +
geom_boxplot() +
facet_wrap(~housing)
price.byRegion <- house.price %>%
mutate(year = format(Date,"%Y")) %>%
group_by(year)
price.byRegion.melted <- price.byRegion %>%
select(year, c('LONDON','NORTH WEST')) %>%
gather(key='region', value='price', -year)
price.byRegion.melted$year <- as.numeric(price.byRegion.melted$year)
View(price.byRegion.melted)
price.byRegion.melted$year <- as.numeric(price.byRegion.melted$year)
price.byRegion.melted$year <- price.byRegion.melted$year - matrix(1994, ncol=1, nrow=566)
price.byRegion.melted$year <- as.factor(price.byRegion.melted$year)
ggplot(price.byRegion.melted, aes(x=year, y=price, fill=region)) +
geom_boxplot() +
facet_wrap(~region)
#### DATA PREPARATION ####
# Import
library(readxl)
excel_sheets('datasets/UK House price index.xls')
house.price <- read_excel('datasets/UK House price index.xls', sheet="Average price")
lapply(house.price, class) # Cek class tiap kolom pada dataframe
# alternative
#str(house.price)
library(dplyr)
library(tidyr)
### Housing group by Date (year)
price.byHousing <- house.price %>%
mutate(year = format(Date, "%Y")) %>%
group_by(year) %>%
summarise(across('City of London':'Westminster', mean))
# Convert year to POSIXct
price.byHousing$year <- as.POSIXct(price.byHousing$year, format = "%Y")
### Region group by Date (year)
price.byRegion <- house.price %>%
mutate(year = format(Date,"%Y")) %>%
group_by(year) %>%
summarise(across('NORTH EAST':'SOUTH WEST', mean))
# Convert year to POSIXct
price.byRegion$year <- as.POSIXct(price.byRegion$year, format = "%Y")
# Comparing housing price in City of London and Barking & Dagenham
# Melt
price.byHousing.melted <- price.byHousing %>%
select(year, 'City of London':'Barking & Dagenham') %>%
gather(key='housing', value='price', -year)
# Comparing housing price in LONDON and NORTH WEST
# Melt
price.byRegion.melted <- price.byRegion %>%
select(year, c('LONDON','NORTH WEST')) %>%
gather(key='region', value='price', -year)
#### EDA ####
library(ggplot2)
# Set parameter
housing <- names(price.byHousing[2:34])
region <- names(price.byRegion[2:10])
# Graph price by housing and region
housing.plot1 = ggplot(price.byHousing.melted, aes(x=year, y=price, colour=housing)) +
geom_line() + theme_bw() + labs(title="Housing price for City of London and Barking
& Dagenham", x='Year', y='Price', subtitle="")
housing.plot1
#### DATA PREPARATION ####
# Import
library(readxl)
excel_sheets('datasets/UK House price index.xls')
house.price <- read_excel('datasets/UK House price index.xls', sheet="Average price")
lapply(house.price, class) # Cek class tiap kolom pada dataframe
# alternative
#str(house.price)
library(dplyr)
library(tidyr)
### Housing group by Date (year)
price.byHousing <- house.price %>%
mutate(year = format(Date, "%Y")) %>%
group_by(year) %>%
summarise(across('City of London':'Westminster', mean))
# Convert year to POSIXct
price.byHousing$year <- as.POSIXct(price.byHousing$year, format = "%Y")
### Region group by Date (year)
price.byRegion <- house.price %>%
mutate(year = format(Date,"%Y")) %>%
group_by(year) %>%
summarise(across('NORTH EAST':'SOUTH WEST', mean))
# Convert year to POSIXct
price.byRegion$year <- as.POSIXct(price.byRegion$year, format = "%Y")
# Comparing housing price in City of London and Barking & Dagenham
# Melt
price.byHousing.melted <- price.byHousing %>%
select(year, 'City of London':'Barking & Dagenham') %>%
gather(key='housing', value='price', -year)
# Comparing housing price in LONDON and NORTH WEST
# Melt
price.byRegion.melted <- price.byRegion %>%
select(year, c('LONDON','NORTH WEST')) %>%
gather(key='region', value='price', -year)
#### EDA ####
library(ggplot2)
# Set parameter
housing <- names(price.byHousing[2:34])
region <- names(price.byRegion[2:10])
# Graph price by housing and region
housing.plot1 = ggplot(price.byHousing.melted, aes(x=year, y=price, colour=housing)) +
geom_line() + theme_bw() + labs(title="Housing price for City of London and Barking
& Dagenham", x='Year', y='Price', subtitle="")
housing.plot1
View(price.byHousing.melted)
#### NORMALITY TEST ####
hist(house.price$'City of London', breaks=50, include.lowest = F, right = F)
